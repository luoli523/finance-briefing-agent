# 更新日志 (Changelog)

## [未发布] - 2026-01-21

### 新增功能 ✨

#### 1. 完整的持仓明细显示
- **按行业分类显示所有监控标的**：简报现在包含 12 个行业分类，覆盖全部 51 只标的
  - 主要指数 (6只)
  - ETF (6只)
  - 科技巨头 (7只)
  - 半导体 (13只)
  - 存储 (3只)
  - 数据中心 (3只)
  - 能源/核电 (5只)
  - AI/软件 (2只)
  - 航天 (1只)
  - 金融 (3只)
  - 保险科技 (1只)
  - 医疗 (1只)

- **详细的板块统计**：每个板块显示
  - 平均涨跌幅
  - 上涨/下跌标的数量
  - 完整的标的列表（按涨跌幅排序）

#### 2. 历史数据保存和对比 📊
- **自动保存每日收盘数据**
  - 收集器现在会自动将每日收盘数据保存到 `data/history/market-history.json`
  - 保留最近 90 天的历史数据
  - 支持历史数据查询和对比

- **历史数据管理 API**
  - `HistoryManager` 类提供完整的历史数据管理功能
  - 支持按日期、按股票代码查询历史数据
  - 支持多日期对比分析

- **未来功能预留**：简报生成器已预留历史对比接口
  - 当历史数据充足时，简报将自动显示"对比前日"列
  - 可以对比任意历史交易日的涨跌情况

### 改进 🔧

#### 简报结构优化
- 将"主要指数"、"板块表现"、"涨跌榜"整合为"全部持仓明细（按行业分类）"
- 保留"涨跌榜 Top 5"作为快速概览
- 简报内容从 750 词增加到 1564 词，信息更加全面

#### 代码结构优化
- 新增 `src/collectors/history.ts` - 历史数据管理模块
- 更新 `src/analyzers/market.ts` - 支持指数作为独立板块分类
- 更新 `src/generators/markdown.ts` - 支持异步生成和历史对比

### 技术细节 🔧

#### 新增文件
```
src/collectors/history.ts          # 历史数据管理器
data/history/market-history.json   # 历史数据存储
```

#### 修改文件
```
src/collectors/index.ts            # 导出历史管理器
src/collectors/yahoo-finance.ts    # 自动保存历史数据
src/analyzers/market.ts            # 完善板块分类
src/generators/markdown.ts         # 支持完整持仓和历史对比
```

### 使用方法 📖

#### 查看完整简报
```bash
npm run collect && npm run analyze && npm run generate
```

生成的简报将包含：
- ✅ 51 只标的的完整持仓明细
- ✅ 按 12 个行业分类显示
- ✅ 每个标的的当前价、日涨跌、日涨跌幅
- ⏳ 历史对比（需要多日数据后自动显示）

#### 历史数据位置
- 存储位置：`data/history/market-history.json`
- 保留时长：最近 90 天
- 更新频率：每次运行 `npm run collect` 自动更新

### 未来计划 🚀

- [ ] 添加周对比、月对比功能
- [ ] 添加历史趋势图表
- [ ] 支持自定义历史对比时间范围
- [ ] 添加历史数据导出功能
- [ ] 支持历史回测分析

---

## [1.0.0] - 2026-01-21

### 初始版本
- 多源数据收集 (Yahoo Finance, Finnhub, FRED)
- 智能数据分析 (市场、新闻、经济)
- 多格式输出 (Markdown, HTML)
